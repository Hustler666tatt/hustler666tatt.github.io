<!-- QRCode.js (CDN confiable) -->
<script src="https://cdn.jsdelivr.net/gh/davidshimjs/qrcodejs/qrcode.min.js"></script>
<script>
  // URL de destino (cambiá esto si querés que el QR apunte a otra página)
  const URL = "https://hustler666tatt.github.io/";

  const box = document.getElementById('q');

  function renderWithLib() {
    // Si la librería cargó, existe window.QRCode
    if (window.QRCode) {
      new QRCode(box, {
        text: URL,
        width: 300,
        height: 300,
        correctLevel: QRCode.CorrectLevel.H,
        colorDark: "#000000",
        colorLight: "#ffffff"
      });
      return true;
    }
    return false;
  }

  function renderFallback() {
    // Fallback: imagen de un servicio público (rápido y fiable)
    const api = "https://api.qrserver.com/v1/create-qr-code/?size=300x300&data=" + encodeURIComponent(URL);
    const img = new Image();
    img.width = 300; img.height = 300; img.alt = "QR";
    img.src = api;
    box.innerHTML = "";
    box.appendChild(img);
  }

  // Intenta con la librería; si no, usa fallback
  if (!renderWithLib()) renderFallback();

  // Descargar PNG
  document.getElementById('dl').onclick = () => {
    const canvas = box.querySelector("canvas");
    const img = box.querySelector("img");
    const data = canvas ? canvas.toDataURL("image/png") : (img ? img.src : null);
    if (!data) return;
    const a = document.createElement("a");
    a.href = data;
    a.download = "hustler-qr.png";
    a.click();
  };
</script>
